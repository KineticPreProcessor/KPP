############################
Installing KPP-for-GEOS-Chem
############################

Once you have made sure that your system meets all the :ref:`System
Requirements`, you may download and install :program:`KPP-for-GEOS-Chem`.

-----------
Downloading
-----------

Use this command to download the :program:`KPP-for-GEOS-Chem` source
code from the :file:`GC_updates` branch
of the `KPP Github repository <https://github.com/geoschem/KPP>`__:

.. code-block:: console

   $ git clone -b GC_updates https://github.com/geoschem/KPP.git

.. important:: Do not download the :program:`KPP-for-GEOS-Chem` source code into your
	       :program:`GEOS-Chem` source code directory! This will avoid
	       confusion with the KPP folder within :program:`GEOS-Chem`.

	       The KPP folder within the :program:`GEOS-Chem` source code
	       contains the Fortran-90 files that were generated by
	       :program:`KPP-for-GEOS-Chem`. These files define the chemical
	       mechanism that will be used in :program:`GEOS-Chem` simulations.

.. tip:: If you wish to generate chemical mechanisms for a
	 standalone chemical box model instead of for GEOS-Chem, then
	 download the :program:`KPP` code from the :file:`main` branch instead of from
	 file:`GC_updates`.  This will give you the unmodified :program:`KPP`
	 version 2.2.3_01.

---------
Compiling
---------

Build the KPP-for-GEOS-Chem executable file with these commands:

.. code-block:: console

   $ cd KPP/kpp-code
   $ make distclean
   $ make all

If the build completes successfully, you will see the executable file :file:`KPP/kpp-code/bin/kpp`.

----------------
Setting the path
----------------

Once have built :program:`KPP-for-GEOS-Chem`, you must add the path to the
executable file to your :envvar:`PATH` environment variable.

If you use the bash Unix shell, add these lines to your
:file:`~/.bash_aliases` file.  If you don't have a
:file:`~/.bash_aliases` file, you can add these lines to your
:file:`~/.bashrc` file instead.)

.. code-block:: none

   export PATH=$PATH:/PATH_TO_KPP/KPP/kpp-code/bin/
   export KPP_HOME=PATH_TO_KPP/KPP/kpp-code`

If you use the csh or tcsh Unix shell, add these lines to your
:file:`~/.cshrc` file:

.. code-block:: none

   setenv PATH $PATH:/PATH_TO_KPP/KPP/kpp-code/bin/
   setenv KPP_HOME=PATH_TO_KPP/KPP/kpp-code

.. note:: 

  - For example, if you installed FlexChem-KPP into your home
    directory, then  :code:`PATH_TO_KPP` would be :file:`~/KPP`, etc.
    
